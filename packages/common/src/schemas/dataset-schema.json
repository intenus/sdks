{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://intenus.io/schemas/dataset.json",
  "title": "Intenus ML Dataset Schema",
  "description": "JSON Schema for ML training dataset types",
  "definitions": {
    "RawFeatures": {
      "type": "object",
      "description": "Raw features extracted from IGSIntent for ML training",
      "required": [
        "solver_window_ms",
        "user_decision_timeout_ms",
        "time_to_deadline_ms",
        "max_slippage_bps",
        "has_whitelist",
        "has_blacklist",
        "has_limit_price",
        "optimization_goal",
        "surplus_weight",
        "gas_cost_weight",
        "execution_speed_weight",
        "reputation_weight",
        "require_simulation",
        "input_count",
        "output_count",
        "input_asset_types",
        "output_asset_types",
        "input_value_usd",
        "expected_output_value_usd",
        "benchmark_source",
        "benchmark_confidence",
        "expected_gas_usd",
        "has_nlp_input",
        "client_platform",
        "tag_count"
      ],
      "properties": {
        "solver_window_ms": { "type": "number" },
        "user_decision_timeout_ms": { "type": "number" },
        "time_to_deadline_ms": { "type": "number" },
        "time_in_force": {
          "type": "string",
          "enum": ["immediate", "good_til_cancel", "fill_or_kill"]
        },
        "max_slippage_bps": { "type": "number" },
        "max_gas_cost_usd": { "type": "number" },
        "max_hops": { "type": "number" },
        "has_whitelist": { "type": "boolean" },
        "has_blacklist": { "type": "boolean" },
        "has_limit_price": { "type": "boolean" },
        "optimization_goal": {
          "type": "string",
          "enum": ["maximize_output", "minimize_gas", "fastest_execution", "balanced"]
        },
        "surplus_weight": { "type": "number", "minimum": 0, "maximum": 100 },
        "gas_cost_weight": { "type": "number", "minimum": 0, "maximum": 100 },
        "execution_speed_weight": { "type": "number", "minimum": 0, "maximum": 100 },
        "reputation_weight": { "type": "number", "minimum": 0, "maximum": 100 },
        "require_simulation": { "type": "boolean" },
        "input_count": { "type": "number" },
        "output_count": { "type": "number" },
        "input_asset_types": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["native", "stable", "volatile"]
          }
        },
        "output_asset_types": {
          "type": "array",
          "items": {
            "type": "string",
            "enum": ["native", "stable", "volatile"]
          }
        },
        "input_value_usd": { "type": "number" },
        "expected_output_value_usd": { "type": "number" },
        "benchmark_source": { "type": "string" },
        "benchmark_confidence": { "type": "number", "minimum": 0, "maximum": 1 },
        "expected_gas_usd": { "type": "number" },
        "expected_slippage_bps": { "type": "number" },
        "has_nlp_input": { "type": "boolean" },
        "nlp_confidence": { "type": "number", "minimum": 0, "maximum": 1 },
        "client_platform": { "type": "string" },
        "tag_count": { "type": "number" }
      }
    },
    "GroundTruthLabel": {
      "type": "object",
      "description": "Ground truth classification labels",
      "required": ["primary_category", "detected_priority", "complexity_level", "risk_level"],
      "properties": {
        "primary_category": {
          "type": "string",
          "enum": ["swap", "limit_order", "complex_defi", "arbitrage", "other"]
        },
        "detected_priority": {
          "type": "string",
          "enum": ["speed", "cost", "output", "balanced"]
        },
        "complexity_level": {
          "type": "string",
          "enum": ["simple", "moderate", "complex"]
        },
        "risk_level": {
          "type": "string",
          "enum": ["low", "medium", "high"]
        }
      }
    },
    "LabelingMetadata": {
      "type": "object",
      "description": "Labeling metadata",
      "required": ["labeling_method", "labeled_by", "labeled_at", "label_confidence"],
      "properties": {
        "labeling_method": {
          "type": "string",
          "enum": ["expert_manual", "rule_based", "outcome_based", "user_feedback", "synthetic"]
        },
        "labeled_by": { "type": "string" },
        "labeled_at": { "type": "number" },
        "label_confidence": { "type": "number", "minimum": 0, "maximum": 1 },
        "notes": { "type": "string" }
      }
    },
    "ExecutionOutcome": {
      "type": "object",
      "description": "Execution outcome for feedback loop",
      "required": ["executed"],
      "properties": {
        "executed": { "type": "boolean" },
        "chosen_solution_rank": { "type": "number" },
        "chosen_solution_id": { "type": "string" },
        "actual_metrics": {
          "type": "object",
          "required": ["actual_output_usd", "actual_gas_cost_usd", "actual_execution_time_ms", "actual_slippage_bps"],
          "properties": {
            "actual_output_usd": { "type": "number" },
            "actual_gas_cost_usd": { "type": "number" },
            "actual_execution_time_ms": { "type": "number" },
            "actual_slippage_bps": { "type": "number" }
          }
        },
        "user_satisfaction": {
          "type": "number",
          "enum": [1, 2, 3, 4, 5]
        },
        "executed_at": { "type": "number" }
      }
    },
    "IntentClassificationTrainingData": {
      "type": "object",
      "description": "Complete training sample for intent classification",
      "required": ["sample_id", "intent_metadata", "raw_features", "ground_truth", "label_info", "dataset_version", "created_at"],
      "properties": {
        "sample_id": { "type": "string" },
        "intent_metadata": {
          "type": "object",
          "required": ["intent_id", "intent_type", "created_at"],
          "properties": {
            "intent_id": { "type": "string" },
            "intent_type": { "type": "string" },
            "created_at": { "type": "number" }
          }
        },
        "raw_features": { "$ref": "#/definitions/RawFeatures" },
        "ground_truth": { "$ref": "#/definitions/GroundTruthLabel" },
        "label_info": { "$ref": "#/definitions/LabelingMetadata" },
        "execution_outcome": { "$ref": "#/definitions/ExecutionOutcome" },
        "dataset_version": { "type": "string" },
        "created_at": { "type": "number" },
        "full_intent_ref": { "type": "string" }
      }
    }
  }
}
